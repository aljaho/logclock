<!DOCTYPE html>
<html lang="fi">
<head>
<meta charset="UTF-8" />
<title>Äänikello</title>
<style>
  body {
    margin: 0;
    background: white;
    overflow: hidden;
    font-family: Arial, sans-serif;
  }
  canvas {
    display: block;
  }
</style>
</head>
<body>
<canvas id="clock"></canvas>

<script>
// Lista äänitiedostoista (samanlaisia ääniä, esim. chime1.mp3, chime2.mp3, chime3.mp3)
const chimeSounds = [
  "sounds/chime1.mp3",
  "sounds/chime2.mp3",
  "sounds/chime3.mp3"
];

// Lataa Audio-objektit
const chimes = chimeSounds.map(src => new Audio(src));

window.addEventListener("load", () => {
    playChimes(5); // Soitetaan viisi satunnaista ääntä
});
  
// Soita ääni satunnaisesti valitusta äänilistasta
function getRandomChime() {
  return chimes[Math.floor(Math.random() * chimes.length)];
}

// Soita ääni useita kertoja peräkkäin (odottaa aina, että ääni loppuu)
async function playChimes(count) {
  for (let i = 0; i < count; i++) {
    const sound = getRandomChime();
    await playSound(sound);
  }
}

// Viimeksi soitettu tunnin ja puolitunnin tarkistus, jotta ei soiteta sama uudelleen
let lastPlayedHour = null;
let lastPlayedHalfHour = null;

function checkAndPlayChimes() {
  const now = new Date();
  const hour = now.getHours();
  const minute = now.getMinutes();
  const second = now.getSeconds();

  // Tasatunti
  if (minute === 0 && second === 0) {
    if (lastPlayedHour !== hour) {
      lastPlayedHour = hour;
      lastPlayedHalfHour = null; // Nollaa puolitunnin soittomahdollisuus uudelle puolikkaalle
      // 12-tunnin muoto, 0 => 12
      const chimeCount = hour % 12 === 0 ? 12 : hour % 12;
      playChimes(chimeCount);
    }
  }
  // Puolitunti
  else if (minute === 30 && second === 0) {
    if (lastPlayedHalfHour !== hour) {
      lastPlayedHalfHour = hour;
      lastPlayedHour = null; // Nollaa tunnin soittomahdollisuus uudelle tunnille
      playChimes(1);
    }
  }
}

// Tarkistus joka sekunti
setInterval(checkAndPlayChimes, 1000);

// --- Kellon piirto ---

const canvas = document.getElementById("clock");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

function drawClock() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const cx = canvas.width / 2;
  const cy = canvas.height / 2;
  const radius = Math.min(cx, cy) * 0.8;

  // Kellotausta
  ctx.beginPath();
  ctx.arc(cx, cy, radius, 0, 2 * Math.PI);
  ctx.fillStyle = "#f0f0f0";
  ctx.fill();
  ctx.lineWidth = 4;
  ctx.strokeStyle = "#333";
  ctx.stroke();

  // Kellon numerot (1-12)
  ctx.fillStyle = "#000";
  ctx.font = `${radius * 0.12}px Arial`;
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  for (let num = 1; num <= 12; num++) {
    const angle = (num - 3) * (Math.PI * 2) / 12; // 12 kohdalla ylhäällä
    const x = cx + Math.cos(angle) * radius * 0.75;
    const y = cy + Math.sin(angle) * radius * 0.75;
    ctx.fillText(num.toString(), x, y);
  }

  // Viisarit
  const now = new Date();
  const hour = now.getHours() % 12;
  const minute = now.getMinutes();
  const second = now.getSeconds();

  // Tunnin viisari
  const hourAngle = ((hour + minute / 60) * 30 - 90) * Math.PI / 180;
  ctx.beginPath();
  ctx.lineWidth = 6;
  ctx.lineCap = "round";
  ctx.moveTo(cx, cy);
  ctx.lineTo(cx + Math.cos(hourAngle) * radius * 0.5, cy + Math.sin(hourAngle) * radius * 0.5);
  ctx.stroke();

  // Minuutin viisari
  const minuteAngle = (minute * 6 - 90) * Math.PI / 180;
  ctx.beginPath();
  ctx.lineWidth = 4;
  ctx.moveTo(cx, cy);
  ctx.lineTo(cx + Math.cos(minuteAngle) * radius * 0.75, cy + Math.sin(minuteAngle) * radius * 0.75);
  ctx.stroke();

  // Sekuntiviisari
  const secondAngle = (second * 6 - 90) * Math.PI / 180;
  ctx.beginPath();
  ctx.strokeStyle = "red";
  ctx.lineWidth = 2;
  ctx.moveTo(cx, cy);
  ctx.lineTo(cx + Math.cos(secondAngle) * radius * 0.85, cy + Math.sin(secondAngle) * radius * 0.85);
  ctx.stroke();
  ctx.strokeStyle = "#333"; // Palauta väri

  requestAnimationFrame(drawClock);
}

drawClock();

</script>
</body>
</html>


