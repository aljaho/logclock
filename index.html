<!DOCTYPE html>
<html lang="fi">
<head>
<meta charset="UTF-8" />
<title>Äänikello</title>
<style>
  body {
    margin: 0;
    background: white;
    overflow: hidden;
    font-family: Arial, sans-serif;
  }
  canvas {
    display: block;
  }
</style>
</head>
<body>
<canvas id="clock"></canvas>

<script>
// Perusäänet: Lisää tähän äänitiedostojen polut
const chimeSounds = [
  "sounds/chime1.mp3",
  "sounds/chime2.mp3",
  "sounds/chime3.mp3"
];

const halfChimeSounds = [
  "sounds/halfchime1.mp3",
  "sounds/halfchime2.mp3"
];

// Luo Audio-objektit äänistä
function loadAudioArray(sources) {
  return sources.map(src => new Audio(src));
}

const chimes = loadAudioArray(chimeSounds);
const halfChimes = loadAudioArray(halfChimeSounds);

// Soittaa yhden äänen ja palauttaa lupauksen kun ääni loppuu
function playSound(audio) {
  return new Promise(resolve => {
    audio.currentTime = 0;
    audio.play();
    audio.onended = resolve;
  });
}

// Soita useita kertoja peräkkäin, odottaen että jokainen ääni loppuu
async function playMultipleSounds(audioArray, count) {
  for (let i = 0; i < count; i++) {
    // Valitse satunnainen ääni
    const sound = audioArray[Math.floor(Math.random() * audioArray.length)];
    await playSound(sound);
  }
}

// Tallenna viimeisin soitettu tunti, jotta ei soita samaa ääntä uudelleen samassa tunnissa
let lastPlayedHour = null;
// Ja puolitunnin soitto samaan tapaan
let lastPlayedHalfHour = null;

function checkAndPlayChimes() {
  const now = new Date();
  const h = now.getHours() % 12 || 12; // 12-tunnin muoto (0 -> 12)
  const m = now.getMinutes();
  const s = now.getSeconds();

  if (m === 0 && s === 0) {
    // Tasatunti
    if (lastPlayedHour !== now.getHours()) {
      lastPlayedHour = now.getHours();
      playMultipleSounds(chimes, h);
    }
  } else if (m === 30 && s === 0) {
    // Puolitunti
    if (lastPlayedHalfHour !== now.getHours() * 60 + 30) {
      lastPlayedHalfHour = now.getHours() * 60 + 30;
      // Soitetaan yksi satunnainen puolitunnin ääni
      const sound = halfChimes[Math.floor(Math.random() * halfChimes.length)];
      playSound(sound);
    }
  }
}

// Päivitä ja tarkista äänet sekunnin välein
setInterval(checkAndPlayChimes, 1000);


// --- Kello jatkuu tässä ---

const canvas = document.getElementById("clock");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

// Piirrä kello (voit lisätä tähän koodisi kellon piirtämiseen)
function drawClock() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  const cx = canvas.width / 2;
  const cy = canvas.height / 2;
  const radius = Math.min(cx, cy) * 0.8;
  
  ctx.beginPath();
  ctx.arc(cx, cy, radius, 0, 2 * Math.PI);
  ctx.fillStyle = "#f0f0f0";
  ctx.fill();
  ctx.lineWidth = 4;
  ctx.strokeStyle = "#333";
  ctx.stroke();
  
  // Lisää kellon numerot jne. halutessasi

  // Piirrä kelloajan viisarit (voit lisätä koodisi tähän)
  
  requestAnimationFrame(drawClock);
}

drawClock();

</script>
</body>
</html>
